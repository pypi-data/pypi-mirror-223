(self.webpackChunkasqlcell=self.webpackChunkasqlcell||[]).push([[118],{5593:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Chart=void 0;const l=a(8952),r=n(a(6271)),i=a(694),o=a(556);t.Chart=()=>r.default.createElement(l.Group,{noWrap:!0},r.default.createElement(i.ChartConfig,null),r.default.createElement(l.Divider,{orientation:"vertical"}),r.default.createElement(o.ChartPreview,null))},5690:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigCommand=void 0;const l=a(8952),r=a(2752),i=n(a(6271)),o=a(7295);t.ConfigCommand=()=>{const[e]=o.useModelState("preview_vega"),[,t]=o.useModelState("persist_vega");return i.default.createElement(l.Group,null,i.default.createElement(l.Button,{compact:!0,onClick:()=>t((new Date).toString()),disabled:"{}"===e,leftIcon:i.default.createElement(r.IconPin,{stroke:1.5,size:14})},"Pin"))}},694:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartConfig=void 0;const l=a(8952),r=a(2752),i=n(a(6271)),o=a(5690),c=a(9162),u=a(8743),s=a(6399);t.ChartConfig=()=>i.default.createElement(l.Tabs,{defaultValue:"config"},i.default.createElement(l.Tabs.List,null,i.default.createElement(l.Tabs.Tab,{value:"config",icon:i.default.createElement(r.IconSettings,{stroke:1.5,size:16})},"Config"),i.default.createElement(l.Tabs.Tab,{value:"display",icon:i.default.createElement(r.IconPresentation,{stroke:1.5,size:16})},"Display")),i.default.createElement(l.Tabs.Panel,{value:"config",pt:"xs"},i.default.createElement(l.ScrollArea,{h:500,sx:{padding:5}},i.default.createElement(l.Stack,{justify:"flex-start"},i.default.createElement(s.ChartPicker,null),i.default.createElement(u.ChartProperties,null),i.default.createElement(l.Space,{h:"xl"}),i.default.createElement(o.ConfigCommand,null)))),i.default.createElement(l.Tabs.Panel,{value:"display",pt:"xs"},i.default.createElement(l.ScrollArea,{h:500,sx:{padding:5}},i.default.createElement(l.Stack,{justify:"flex-start"},i.default.createElement(c.DisplaySize,null)))))},7373:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DataTypeIcons=t.DataType=t.ChartType=t.LabelWidth=t.MenuWidth=t.MenuHeight=t.ViewHeight=void 0;const l=a(2752),r=n(a(6271));var i,o;t.ViewHeight=264,t.MenuHeight=311,t.MenuWidth=285,t.LabelWidth=128,(o=t.ChartType||(t.ChartType={})).Bar="bar",o.Column="column",o.Line="line",o.Area="area",o.Scatter="scatter",o.Pie="pie",function(e){e.Int="int",e.Float="float",e.String="string",e.Bool="bool",e.Datetime="datetime"}(i=t.DataType||(t.DataType={})),t.DataTypeIcons={[i.Int]:r.default.createElement(l.Icon123,{stroke:1.5,size:18}),[i.Float]:r.default.createElement(l.Icon123,{stroke:1.5,size:18}),[i.String]:r.default.createElement(l.IconAbc,{stroke:1.5,size:18}),[i.Bool]:r.default.createElement(l.IconAbc,{stroke:1.5,size:18}),[i.Datetime]:r.default.createElement(l.IconCalendar,{stroke:1.5,size:18})}},9162:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DisplaySize=void 0;const l=a(8952),r=a(2752),i=n(a(6271)),o=a(7295);t.DisplaySize=()=>{const[e,t]=o.useModelState("chart_config"),a=JSON.parse(e),n=a.width,c=a.height,u=a.label,s=a.legend;return i.default.createElement(l.Stack,null,i.default.createElement(l.NumberInput,{defaultValue:0,label:"Width",max:1e4,min:0,icon:i.default.createElement(r.IconArrowAutofitWidth,{stroke:1.5,size:14}),step:100,sx:{width:240},value:n,onChange:e=>{const n=Object.assign(Object.assign({},a),{width:e});t(JSON.stringify(n))}}),i.default.createElement(l.NumberInput,{defaultValue:0,label:"Height",max:1e4,min:0,icon:i.default.createElement(r.IconArrowAutofitHeight,{stroke:1.5,size:14}),step:100,sx:{width:240},value:c,onChange:e=>{const n=Object.assign(Object.assign({},a),{height:e});t(JSON.stringify(n))}}),i.default.createElement(l.Switch,{value:"visible",label:"Show label",checked:u,onChange:e=>{const n=Object.assign(Object.assign({},a),{label:e.currentTarget.checked});t(JSON.stringify(n))}}),i.default.createElement(l.Switch,{value:"visible",label:"Show legend",checked:s.visible,onChange:e=>{const n=Object.assign(Object.assign({},a),{legend:Object.assign(Object.assign({},a.legend),{visible:e.currentTarget.checked})});t(JSON.stringify(n))}}))}},5082:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HistChart=void 0;const l=n(a(6271)),r=a(9581),i=a(8952);t.HistChart=({item:e,headerContent:t})=>{const a=e=>{let t="";return t=0===e?"0":(e=>!(.1<=Math.abs(e)&&Math.abs(e)<=1e4))(e)?(e=>e.toExponential(2))(e):e.toFixed(2),t},n={table:t.bins.map(((e,t)=>({a:`[${a(e.bin_start)}, ${a(e.bin_end)}]`,b:e.count,index:t})))};return l.default.createElement(i.Stack,null,l.default.createElement(r.VegaLite,{data:n,actions:!1,renderer:"svg",spec:{background:"transparent",data:{name:"table"},width:60,height:40,config:{view:{stroke:null}},layer:[{params:[{name:"hover",select:{type:"point",on:"mouseover",clear:"mouseout"}}],mark:{type:"bar",color:"#eee",tooltip:!0},transform:[{calculate:"datum.a + ': ' +datum.b",as:"tooltip"}],encoding:{x:{field:"index",type:"nominal",axis:{labels:!1,title:null}},tooltip:{field:"tooltip",type:"nominal"},opacity:{condition:{test:{param:"hover",empty:!1},value:.5},value:0},detail:[{field:"count"}]}},{mark:"bar",transform:[{calculate:"datum.b===0 ? 0 : datum.b === 1? 0.5: log(datum.b)/log(2)",as:"log_x"}],encoding:{x:{field:"index",type:"nominal",axis:{labels:!1,title:null,ticks:!1}},y:{field:"log_x",type:"quantitative",axis:{labels:!1,domain:!1,grid:!1,ticks:!1,title:null}}}}]}}),l.default.createElement(i.Group,{sx:{width:"max-content"}},l.default.createElement(i.Text,{size:"xs",c:"#696969",sx:{marginTop:"-20px"}},(e=>{const n=t.bins[0].bin_start,l=t.bins[9].bin_end;return`[${a(n)}, ${a(l)}]`})())))}},5102:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),l(a(5082),t),l(a(1904),t),l(a(694),t),l(a(5593),t),l(a(7373),t)},501:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return l(t,e),t},i=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.IconItem=void 0;const o=a(8952),c=r(a(6271));t.IconItem=c.forwardRef(((e,t)=>{var{icon:a,value:n,label:l}=e,r=i(e,["icon","value","label"]);return c.default.createElement(o.Group,Object.assign({noWrap:!0,ref:t},r),a,c.default.createElement(o.Text,{size:"sm"},l))}))},556:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartPreview=void 0;const l=a(8952),r=n(a(6271)),i=a(9581),o=a(7295);t.ChartPreview=()=>{const[e]=o.useModelState("preview_vega"),t=JSON.parse(e);return"$schema"in t?r.default.createElement(l.ScrollArea,{style:{width:"100%"}},r.default.createElement(i.VegaLite,{renderer:"svg",actions:{export:!0,source:!1,compiled:!1,editor:!1},spec:t})):r.default.createElement(r.default.Fragment,null)}},8743:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartProperties=void 0;const i=a(8952),o=a(2752),c=r(a(6271)),u=a(7295),s=a(7373),d=a(501);var f;!function(e){e.Ascending="ascending",e.Descending="descending",e.Naturally="naturally"}(f||(f={}));const p=e=>[...JSON.parse(e)].map((e=>({value:e.columnName,label:e.columnName,icon:s.DataTypeIcons[e.dtype]}))),m=()=>{const[e,t]=u.useModelState("chart_config"),[a,n]=c.useState(!1),l=Object.keys(s.ChartType).find((t=>s.ChartType[t]===JSON.parse(e).type)),r=s.ChartType[l],d=(e,t)=>e===s.ChartType.Pie?t===f.Ascending?"+color":"-color":t===f.Naturally?null:t;return c.default.createElement(i.Menu,{width:160,opened:a,onChange:n,position:"right",shadow:"md",withArrow:!0},c.default.createElement(i.Menu.Target,null,c.default.createElement(i.ActionIcon,{mt:"xl",variant:"transparent",onClick:()=>n(!0)},c.default.createElement(o.IconSettings,{size:16}))),c.default.createElement(i.Menu.Dropdown,null,c.default.createElement(i.Menu.Label,null,"Sort"),(()=>{switch(r){case s.ChartType.Pie:case s.ChartType.Area:return[f.Ascending,f.Descending];default:return[f.Ascending,f.Descending,f.Naturally]}})().map((a=>(a=>{const n={[f.Ascending]:c.default.createElement(o.IconSortAscending,{stroke:1.5,size:12}),[f.Descending]:c.default.createElement(o.IconSortDescending,{stroke:1.5,size:12}),[f.Naturally]:c.default.createElement(o.IconArrowsSort,{stroke:1.5,size:12})}[a];return c.default.createElement(i.Menu.Item,{onClick:()=>{const n=Object.assign(Object.assign({},JSON.parse(e)),{sort:d(r,a)});t(JSON.stringify(n))},icon:n},c.default.createElement(i.Text,{tt:"capitalize"},a))})(a)))))},h=()=>{const[e,t]=u.useModelState("chart_config"),[a,n]=c.useState(!1),l=Object.keys(s.ChartType).find((t=>s.ChartType[t]===JSON.parse(e).type)),r=s.ChartType[l],d=JSON.parse(e).aggregation,p=(e,t)=>{switch(e){case s.ChartType.Bar:return t===f.Ascending?"x":"-x";case s.ChartType.Pie:return t===f.Ascending?"+theta":"-theta";default:return t===f.Ascending?"y":"-y"}};return c.default.createElement(i.Menu,{width:160,opened:a,onChange:n,position:"right",shadow:"md",withArrow:!0},c.default.createElement(i.Menu.Target,null,c.default.createElement(i.ActionIcon,{mt:"xl",variant:"transparent",onClick:()=>n(!0)},c.default.createElement(o.IconSettings,{size:16}))),c.default.createElement(i.Menu.Dropdown,null,c.default.createElement(i.Menu.Label,null,"Aggregation"),["sum","average","max","min","count","median"].map((a=>{return n=a,c.default.createElement(i.Menu.Item,{onClick:()=>{const a=Object.assign(Object.assign({},JSON.parse(e)),{aggregation:n});t(JSON.stringify(a))},icon:c.default.createElement(o.IconCheck,{color:d===n?void 0:"",size:12})},c.default.createElement(i.Text,{tt:"capitalize"},n));var n})),c.default.createElement(i.Menu.Divider,null),c.default.createElement(i.Menu.Label,null,"Sort"),[f.Ascending,f.Descending].map((a=>((a,n)=>{const l={[f.Ascending]:c.default.createElement(o.IconSortAscending,{stroke:1.5,size:12}),[f.Descending]:c.default.createElement(o.IconSortDescending,{stroke:1.5,size:12}),[f.Naturally]:c.default.createElement(o.IconArrowsSort,{stroke:1.5,size:12})}[n];return c.default.createElement(i.Menu.Item,{onClick:()=>{const l=Object.assign(Object.assign({},JSON.parse(e)),{sort:p(a,n)});t(JSON.stringify(l))},icon:l},c.default.createElement(i.Text,{tt:"capitalize"},n))})(r,a)))))},g=()=>{var e;const[t,a]=u.useModelState("chart_config"),[n]=u.useModelState("title_hist"),l=Object.keys(s.ChartType).find((e=>s.ChartType[e]===JSON.parse(t).type)),r=s.ChartType[l],o=p(n),f=JSON.parse(t).x,g=null===(e=o.find((e=>e.value===f)))||void 0===e?void 0:e.icon;return c.default.createElement(i.Group,{noWrap:!0,spacing:"xs"},c.default.createElement(i.Select,{label:"X-Axis",searchable:!0,data:o,icon:g,value:f,itemComponent:d.IconItem,onChange:e=>{const n=Object.assign(Object.assign({},JSON.parse(t)),{x:e});a(JSON.stringify(n))},sx:{width:240}}),(e=>e===s.ChartType.Bar?c.default.createElement(h,null):c.default.createElement(m,null))(r))},b=()=>{var e;const[t,a]=u.useModelState("chart_config"),[n]=u.useModelState("title_hist"),l=Object.keys(s.ChartType).find((e=>s.ChartType[e]===JSON.parse(t).type)),r=s.ChartType[l],o=p(n),f=JSON.parse(t).y,g=null===(e=o.find((e=>e.value===f)))||void 0===e?void 0:e.icon;return c.default.createElement(i.Group,{noWrap:!0,spacing:"xs"},c.default.createElement(i.Select,{label:"Y-Axis",searchable:!0,data:o,icon:g,value:f,itemComponent:d.IconItem,onChange:e=>{const n=Object.assign(Object.assign({},JSON.parse(t)),{y:e});a(JSON.stringify(n))},sx:{width:240}}),(e=>e===s.ChartType.Bar?c.default.createElement(m,null):c.default.createElement(h,null))(r))},v=()=>{var e;const[t,a]=u.useModelState("chart_config"),[n]=u.useModelState("title_hist"),l=p(n),r=JSON.parse(t).theta,o=null===(e=l.find((e=>e.value===r)))||void 0===e?void 0:e.icon;return c.default.createElement(i.Group,{noWrap:!0,spacing:"xs"},c.default.createElement(i.Select,{label:"Size",searchable:!0,data:l,icon:o,value:r,itemComponent:d.IconItem,onChange:e=>{const n=Object.assign(Object.assign({},JSON.parse(t)),{theta:e});a(JSON.stringify(n))},sx:{width:240}}),c.default.createElement(h,null))},y=()=>{var e;const[t,a]=u.useModelState("chart_config"),[n]=u.useModelState("title_hist"),l=p(n),r=JSON.parse(t).color,o=null===(e=l.find((e=>e.value===r)))||void 0===e?void 0:e.icon,f=Object.keys(s.ChartType).find((e=>s.ChartType[e]===JSON.parse(t).type)),h=s.ChartType[f];return c.default.createElement(i.Group,{noWrap:!0,spacing:"xs"},c.default.createElement(i.Select,{label:"Color",searchable:!0,clearable:!0,data:l,icon:o,value:r,itemComponent:d.IconItem,onChange:e=>{const n=Object.assign(Object.assign({},JSON.parse(t)),{color:e});a(JSON.stringify(n))},sx:{width:240}}),(()=>{if(h===s.ChartType.Pie)return c.default.createElement(m,null)})())};t.ChartProperties=()=>{const[e]=u.useModelState("chart_config"),t=JSON.parse(e).type;return c.default.createElement(i.Stack,null,(()=>{switch(t){case s.ChartType.Column:return c.default.createElement(c.default.Fragment,null,c.default.createElement(g,null),c.default.createElement(b,null),c.default.createElement(y,null));case s.ChartType.Bar:return c.default.createElement(c.default.Fragment,null,c.default.createElement(b,null),c.default.createElement(g,null),c.default.createElement(y,null));case s.ChartType.Area:case s.ChartType.Line:case s.ChartType.Scatter:return c.default.createElement(c.default.Fragment,null,c.default.createElement(g,null),c.default.createElement(b,null),c.default.createElement(y,null));case s.ChartType.Pie:return c.default.createElement(c.default.Fragment,null,c.default.createElement(v,null),c.default.createElement(y,null))}})())}},1904:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.QuickViewChart=void 0;const l=n(a(6271)),r=a(9581),i=a(7295);t.QuickViewChart=()=>{const[e]=i.useModelState("quickview_vega"),t=JSON.parse(e);return"$schema"in t?l.default.createElement(r.VegaLite,{renderer:"svg",actions:{export:!0,source:!1,compiled:!1,editor:!1},spec:t}):l.default.createElement(l.default.Fragment,null)}},6399:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartPicker=void 0;const i=a(8952),o=a(2752),c=r(a(6271)),u=a(7295),s=a(7373),d=a(501),f=[{icon:c.default.createElement(o.IconChartBar,{stroke:1.5,size:18}),value:s.ChartType.Column,label:"Column"},{icon:c.default.createElement(o.IconChartBar,{stroke:1.5,size:18,style:{transform:"rotate(90deg)"}}),value:s.ChartType.Bar,label:"Bar"},{icon:c.default.createElement(o.IconChartLine,{stroke:1.5,size:18}),value:s.ChartType.Line,label:"Line"},{icon:c.default.createElement(o.IconChartAreaLine,{stroke:1.5,size:18}),value:s.ChartType.Area,label:"Area"},{icon:c.default.createElement(o.IconChartDots,{stroke:1.5,size:18}),value:s.ChartType.Scatter,label:"Scatter"},{icon:c.default.createElement(o.IconChartPie,{stroke:1.5,size:18}),value:s.ChartType.Pie,label:"Pie"}];t.ChartPicker=()=>{var e;const[t,a]=u.useModelState("chart_config"),[n,l]=c.useState(!1),r=Object.keys(s.ChartType).find((e=>s.ChartType[e]===JSON.parse(t).type)),p=s.ChartType[r],m=null===(e=f.find((e=>e.value===p)))||void 0===e?void 0:e.icon;return c.default.createElement(i.Group,{noWrap:!0,spacing:"xs"},c.default.createElement(i.Select,{label:"Chart type",searchable:!0,itemComponent:d.IconItem,data:f,icon:m,value:p,onChange:e=>{const n=Object.assign(Object.assign({},JSON.parse(t)),{type:e});a(JSON.stringify(n))},sx:{width:240}}),[s.ChartType.Column,s.ChartType.Bar,s.ChartType.Area].includes(p)?c.default.createElement(i.Menu,{width:160,opened:n,onChange:l,position:"right",shadow:"md",withArrow:!0},c.default.createElement(i.Menu.Target,null,c.default.createElement(i.ActionIcon,{mt:"xl",variant:"transparent",onClick:()=>l(!0)},c.default.createElement(o.IconSettings,{size:16}))),c.default.createElement(i.Menu.Dropdown,null,c.default.createElement(i.Menu.Label,null,"Style"),c.default.createElement(i.Menu.Item,{onClick:()=>{const e=Object.assign(Object.assign({},JSON.parse(t)),{subtype:[]});a(JSON.stringify(e))},icon:c.default.createElement(o.IconStack,{size:12})},"Stack"),[s.ChartType.Area,s.ChartType.Area].includes(p)?void 0:c.default.createElement(i.Menu.Item,{onClick:()=>{const e=Object.assign(Object.assign({},JSON.parse(t)),{subtype:["clustered"]});a(JSON.stringify(e))},icon:c.default.createElement(o.IconChartBar,{size:12})},"Clustered"),c.default.createElement(i.Menu.Item,{onClick:()=>{const e=Object.assign(Object.assign({},JSON.parse(t)),{subtype:["100"]});a(JSON.stringify(e))},icon:c.default.createElement(o.IconPercentage,{size:12})},"100% Stack"))):void 0)}},1873:(e,t)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.Order=void 0,(a=t.Order||(t.Order={}))[a.Increasing=1]="Increasing",a[a.Descending=-1]="Descending",a[a.None=0]="None"},7295:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useModel=t.useModelEvent=t.useModelState=t.WidgetModelContext=void 0;const n=a(6271);function l(e,t,a){const l=r(),i=void 0===a?[l]:[...a,l];n.useEffect((()=>{const a=e=>l&&t(l,e);return null==l||l.on(e,a),()=>{null==l||l.unbind(e,a)}}),i)}function r(){return n.useContext(t.WidgetModelContext)}t.WidgetModelContext=n.createContext(void 0),t.useModelState=function(e){const t=r(),[a,i]=n.useState(null==t?void 0:t.get(e));return l(`change:${e}`,(t=>{i(t.get(e))}),[e]),[a,function(a,n){null==t||t.set(e,a,n),null==t||t.save_changes()}]},t.useModelEvent=l,t.useModel=r},9118:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return l(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SqlCellView=t.SqlCellModel=void 0;const o=r(a(2565)),c=a(2565),u=i(a(6271)),s=i(a(4456));a(7204);const d=a(1873),f=a(8657),p=i(a(553));class m extends o.DOMWidgetModel{constructor(){super(...arguments),this.defaults=()=>Object.assign(Object.assign({},super.defaults()),{_model_name:m.model_name,_model_module:m.model_module,_model_module_version:m.model_module_version,_view_name:m.view_name,_view_module:m.view_module,_view_module_version:m.view_module_version,data_name:"",dfs_button:"",exec_time:0,row_range:[0,10],column_sort:["",d.Order.None],dfs_result:"",sql_button:"",mode:"",data_grid:"",column_color:"",data_sql:"",quickview_vega:"{}",quickview_var:["",""],quickview_data:"",title_hist:"",cache:"[{}]",chart_config:"{}",preview_vega:"{}",persist_vega:""})}initialize(e,t){super.initialize(e,t),this.set("json_dump",(new Date).toISOString()),this.save_changes()}}t.SqlCellModel=m,m.serializers=Object.assign({},o.DOMWidgetModel.serializers),m.model_name="SqlCellModel",m.model_module=f.MODULE_NAME,m.model_module_version=f.MODULE_VERSION,m.view_name="SqlCellView",m.view_module=f.MODULE_NAME,m.view_module_version=f.MODULE_VERSION;class h extends c.DOMWidgetView{constructor(){super(...arguments),this.render=()=>{this.el.classList.add("custom-widget");const e=u.default.createElement(p.default,{model:this.model});s.default.render(e,this.el)}}}t.SqlCellView=h},2253:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OrderIcons=void 0;const l=n(a(6271)),r=a(9583),i=a(1873);t.OrderIcons={[i.Order.Increasing]:l.default.createElement(r.FaSortUp,{color:"gray",size:10}),[i.Order.Descending]:l.default.createElement(r.FaSortDown,{color:"gray",size:10}),[i.Order.None]:l.default.createElement(r.FaSort,{color:"lightgray",size:10})}},6547:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TableElement=void 0;const l=a(8952),r=a(8027),i=n(a(6271)),o=a(4578);t.TableElement=({item:e})=>{const{ref:t,width:a}=r.useElementSize();return i.default.createElement(l.Popover,{position:"top",withArrow:!0,shadow:"md"},i.default.createElement(l.Group,{ref:t,noWrap:!0,sx:{gap:0}},i.default.createElement(l.Text,{sx:{overflow:"hidden"},fz:"12px"},e.substring(0,Math.max(160,a)/8)),i.default.createElement(l.Popover.Target,null,Math.max(160,a)<8*e.length?i.default.createElement(l.ActionIcon,{variant:"light",color:"blue",sx:{height:"10px",minHeight:"10px",width:"10px",minWidth:"10px"}},i.default.createElement(o.VscEllipsis,{size:8})):i.default.createElement("div",null))),i.default.createElement(l.Popover.Dropdown,{sx:{padding:0}},i.default.createElement(l.Textarea,{readOnly:!0,variant:"unstyled",withAsterisk:!0,defaultValue:e,autosize:!0,minRows:1,maxRows:2,sx:{fontSize:"12px","& .mantine-Textarea-input":{cursor:"default",paddingTop:0,paddingBottom:0}}})))}},4678:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DataframeHeader=void 0;const i=a(8952),o=a(2752),c=r(a(6271)),u=a(5102),s=a(1873),d=a(7295),f=a(2253),p=({header:e,title:t,dataLength:a})=>{const[n,l]=c.useState(void 0);return c.default.createElement(i.Stack,{spacing:0},e.bins.map(((e,r)=>c.default.createElement(i.Group,{key:r,noWrap:!0,position:"apart",onMouseEnter:()=>{l(t)},onMouseLeave:()=>l(void 0),sx:{gap:0,width:"10rem",marginBottom:"-2px"}},e.count>0?c.default.createElement(c.default.Fragment,null,c.default.createElement(i.Box,{sx:{maxWidth:"6rem"}},c.default.createElement(i.Text,{weight:600,fs:"italic",c:"#696969",truncate:!0,fz:"xs"},e.bin)),c.default.createElement(i.Text,{c:"blue",fz:"xs"},n?e.count:(e.count/a*100).toFixed(2)+"%")):c.default.createElement(c.default.Fragment,null)))))},m=({header:e,title:t,dataLength:a})=>{const[,n]=d.useModelState("quickview_var");return c.default.createElement(i.Group,{noWrap:!0,position:"center"},c.default.createElement(u.HistChart,{item:t,headerContent:e}),c.default.createElement(i.Popover,{onOpen:()=>{n([t,(new Date).toISOString()])}},c.default.createElement(i.Popover.Target,null,c.default.createElement(i.ActionIcon,{variant:"transparent",sx:{alignItems:"flex-end"}},c.default.createElement(o.IconChartLine,{size:12}))),c.default.createElement(i.Popover.Dropdown,{sx:{position:"fixed",top:"calc(50vh - 75px) !important",left:"calc(50vw - 240px) !important"}},c.default.createElement(u.QuickViewChart,null))))},h=({header:e,title:t,dataLength:a})=>{const n=e.dtype.includes("int")||e.dtype.includes("float");return c.default.createElement(i.Group,{position:"center"},n?c.default.createElement(m,{header:e,title:t,dataLength:a}):c.default.createElement(p,{header:e,title:t,dataLength:a}))},g=({content:e,title:t})=>{const[a,n]=d.useModelState("column_sort");return c.default.createElement(i.Group,{position:"center"},c.default.createElement(i.Button,{color:"dark",sx:{maxWidth:"10rem",height:"27px","&.mantine-UnstyledButton-root":{":hover":{backgroundColor:"#ebebeb"}}},rightIcon:c.default.createElement(c.default.Fragment,null,c.default.createElement(i.Text,{size:"xs",fs:"italic",color:"gray"},e.dtype.includes("datetime")?"datetime":e.dtype),a[0]===t?f.OrderIcons[a[1]]:f.OrderIcons[s.Order.None]),variant:"subtle",onClick:()=>{if(a[0]===t)switch(a[1]){case s.Order.Increasing:n([a[0],s.Order.Descending]);break;case s.Order.Descending:n([a[0],s.Order.None]);break;default:n([a[0],s.Order.Increasing])}else n([t,s.Order.Increasing])}},c.default.createElement(i.Text,{truncate:!0,fw:700},t)))};t.DataframeHeader=({contents:e,titles:t,dataLength:a})=>c.default.createElement("thead",null,c.default.createElement("tr",null,c.default.createElement("th",null),t.map(((t,n)=>{const l=e.find((e=>e.columnName===t));return c.default.createElement("th",{key:n},c.default.createElement(i.Stack,{justify:"flex-start",spacing:"xs"},c.default.createElement(g,{content:l,title:t}),c.default.createElement(h,{header:l,title:t,dataLength:a})))}))))},2279:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),l(a(4678),t),l(a(8896),t)},8896:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DataTable=void 0;const i=a(2565),o=a(8952),c=a(8027),u=a(2752),s=r(a(6271)),d=a(7295),f=a(6547),p=a(4678),m=({item:e,color:t,activated:a})=>{const n=t>125?0:255,l=s.useRef(),{ref:r,entry:i}=c.useIntersection({root:l.current,threshold:1});return s.default.createElement(o.Box,{ref:r,bg:a&&(null==i?void 0:i.isIntersecting)?`rgb(${t}, ${t}, ${t})`:"transparent",c:a&&(null==i?void 0:i.isIntersecting)?`rgb(${n}, ${n}, ${n})`:"black"},s.default.createElement(o.Text,{sx:{overflow:"hidden"},fz:"12px"},e))};t.DataTable=()=>{const e=d.useModel(),[t]=d.useModelState("data_grid"),[a]=d.useModelState("title_hist"),[n]=d.useModelState("exec_time"),[l]=d.useModelState("column_color"),[r,c]=s.useState((null==e?void 0:e.get("row_range")[1])-(null==e?void 0:e.get("row_range")[0])),[h,g]=s.useState(Math.floor((null==e?void 0:e.get("row_range")[0])/r)+1),[b,v]=s.useState(1),[y,_]=s.useState(!1),[E,O]=s.useState(!1),x=JSON.parse(t.split("\n")[0]),S=t.split("\n")[1]||0,C=JSON.parse(l).data,w=x.columns,M=a?JSON.parse(a):[{columnName:"",dtype:"",bins:[{bin_start:0,bin_end:0,count:0}]}],j=[...Array(x.index.length).keys()].map((e=>s.default.createElement("tr",{key:i.uuid()},s.default.createElement("td",{key:e},x.index[e]),x.data[e].map(((t,a)=>s.default.createElement("td",{key:a,style:{fontSize:"8px"}},"boolean"==typeof t?t?"True":"False":"string"==typeof t?s.default.createElement(f.TableElement,{item:t}):s.default.createElement(m,{item:t,color:C[e]?C[e][a]:255,activated:E})))))));return s.default.createElement(o.Stack,{spacing:10},s.default.createElement(o.ScrollArea,{scrollbarSize:8},s.default.createElement(o.Table,{withBorder:!0,withColumnBorders:!0,striped:!0,sx:{width:"100%","& thead":{height:"57px"},"& td":{maxWidth:"200px"},"& tbody tr td":{padding:"0px 3px"},"&  td:first-of-type":{backgroundColor:"#ebebeb",width:"7%"},"&  tr:first-of-type":{backgroundColor:"#ebebeb"},"&  tr:nth-of-type(even)":{backgroundColor:"#f2f2f2"}}},s.default.createElement(p.DataframeHeader,{contents:M,titles:w,dataLength:S}),s.default.createElement("tbody",null,j))),s.default.createElement(o.Group,{position:"apart",sx:{width:"100%"}},s.default.createElement(o.Group,null,s.default.createElement(o.Text,{color:"#8d8d8d"},S," rows"),n>0?s.default.createElement(o.Text,{color:"#8d8d8d"},n.toFixed(4)," s"):s.default.createElement(s.default.Fragment,null)),s.default.createElement(o.Group,{align:"center"},s.default.createElement(o.Tooltip,{label:"Conditional Formatting",withArrow:!0},s.default.createElement(o.ActionIcon,{variant:"transparent",onClick:()=>{O(!E)}},s.default.createElement(u.IconFilters,{size:16}))),s.default.createElement(o.Group,{sx:{gap:0}},s.default.createElement(o.Select,{sx:{width:"40px",height:"22px",".mantine-Select-item":{padding:"0px"},".mantine-Select-rightSection":{width:"20px"},".mantine-Select-input":{paddingLeft:"1px",paddingRight:"0px",height:"22px",minHeight:"22px",color:"#8d8d8d"}},placeholder:r,data:["10","30","50","100"],onChange:t=>{const a=t;g(1),c(a),null==e||e.trigger("setRange",[0*a,1*a])}}),s.default.createElement(o.Text,{color:"#8d8d8d"},"/page")),t?s.default.createElement(o.Pagination,{size:"xs",page:h,total:Math.ceil(S/r),onChange:t=>{g(t),null==e||e.trigger("setRange",[(t-1)*r,t*r])},styles:e=>({item:{color:e.colors.gray[4],backgroundColor:e.colors.gray[0],"&[data-active]":{color:e.colors.dark[2],backgroundColor:e.colors.gray[4]}}})}):s.default.createElement(s.default.Fragment,null),s.default.createElement(o.Group,{sx:{gap:0}},s.default.createElement(o.Text,{color:"#8d8d8d"},"goto"),s.default.createElement(o.NumberInput,{defaultValue:18,size:"xs",hideControls:!0,error:y,value:h,onBlur:()=>{b>0&&b<=Math.ceil(S/r)?(g(b),_(!1),null==e||e.trigger("setRange",[(b-1)*r,b*r])):_(!0)},onKeyDown:t=>{["Escape","Enter"].indexOf(t.key)>-1&&(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),b>0&&b<=Math.ceil(S/r)?(g(b),_(!1),null==e||e.trigger("setRange",[(b-1)*r,b*r])):_(!0))},onChange:e=>{v(e),e>0&&e<=Math.ceil(S/r)?_(!1):_(!0)},sx:{width:"40px",".mantine-NumberInput-input":{paddingLeft:"5px",paddingRight:"0px",height:"22px",minHeight:"22px"}}})))))}},8657:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MODULE_NAME=t.MODULE_VERSION=void 0;const n=a(4147);t.MODULE_VERSION=n.version,t.MODULE_NAME=n.name},553:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const i=a(8952),o=a(2752),c=r(a(6271)),u=a(5102),s=a(7295),d=a(2279);var f;t.default=(f=()=>{var e;const t=s.useModel(),[a,n]=c.useState(null==t?void 0:t.get("data_grid")),[l,r]=s.useModelState("cache"),f=JSON.parse(""===l?"{ }":l),[p,m]=c.useState(null!==(e=f.tabValue)&&void 0!==e?e:"table");return null==t||t.on("change:data_grid",(()=>{n(null==t?void 0:t.get("data_grid"))})),null==t||t.on("setRange",(e=>{null==t||t.set("row_range",e,""),null==t||t.save_changes()})),a?c.default.createElement(i.Tabs,{defaultValue:"table",value:p,sx:{width:"100%"},onTabChange:e=>{f.tabValue=e,r(JSON.stringify(f)),m(e)}},c.default.createElement(i.Tabs.List,null,c.default.createElement(i.Tabs.Tab,{value:"table",icon:c.default.createElement(o.IconTable,{size:"0.8rem"})},"Table"),c.default.createElement(i.Tabs.Tab,{value:"chart",icon:c.default.createElement(o.IconChartBar,{size:"0.8rem"})},"Chart")),c.default.createElement(i.Tabs.Panel,{value:"table"},c.default.createElement(d.DataTable,null)),c.default.createElement(i.Tabs.Panel,{value:"chart"},c.default.createElement(u.Chart,null))):c.default.createElement(i.Box,{sx:{height:"60px"}})},e=>c.default.createElement(s.WidgetModelContext.Provider,{value:e.model},c.default.createElement(f,Object.assign({},e))))},3889:(e,t,a)=>{(t=a(3645)(!1)).push([e.id,".custom-widget {\n  padding: 0px 2px;\n}\n",""]),e.exports=t},7204:(e,t,a)=>{var n=a(3379),l=a(3889);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.id,l,""]]);n(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"asqlcell","version":"0.1.0","description":"Analytical sql cell for Jupyter","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css"],"homepage":"https://github.com/datarho/asqlcell","bugs":{"url":"https://github.com/datarho/asqlcell/issues"},"license":"BSD-3-Clause","author":{"name":"qizh","email":"qizh@datarho.tech"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/datarho/asqlcell"},"scripts":{"build":"yarn run build:lib && yarn run build:nbextension && yarn run build:labextension:dev","build:prod":"yarn run build:lib && yarn run build:nbextension && yarn run build:labextension","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc","build:nbextension":"webpack","clean":"yarn run clean:lib && yarn run clean:nbextension && yarn run clean:labextension","clean:lib":"rimraf lib","clean:labextension":"rimraf asqlcell/labextension","clean:nbextension":"rimraf asqlcell/nbextension/static/index.js","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","prepack":"yarn run build:lib","test":"jest","watch":"npm-run-all -p watch:*","watch:lib":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch ."},"dependencies":{"@emotion/react":"^11.10.5","@emotion/serialize":"^1.1.1","@emotion/utils":"^1.2.0","@jupyter-widgets/base":"^1.1.10 || ^2.0.0 || ^3.0.0 || ^4.0.0","@mantine/core":"^5.10.0","@mantine/hooks":"^5.10.0","@tabler/icons-react":"^2.14.0","react":"^17.0.2","react-dom":"^17.0.2","react-icons":"^4.7.1","react-vega":"^7.6.0","vega":"^5.22.1","vega-embed":"^6.22.1","vega-lite":"^5.8.0"},"devDependencies":{"@babel/core":"^7.5.0","@babel/preset-env":"^7.5.0","@babel/preset-react":"^7.14.5","@babel/preset-typescript":"^7.14.5","@jupyterlab/builder":"^3.0.0","@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@types/jest":"^26.0.0","@types/react":"^17.0.2","@types/react-dom":"^17.0.2","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","acorn":"^7.2.0","babel-loader":"^8.2.2","css-loader":"^3.2.0","eslint":"^7.4.0","eslint-plugin-react":"^7.31.11","fs-extra":"^7.0.0","identity-obj-proxy":"^3.0.0","jest":"^26.0.0","jest-canvas-mock":"^2.4.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.3","rimraf":"^2.6.2","source-map-loader":"^1.1.3","style-loader":"^1.0.0","ts-jest":"^26.0.0","ts-loader":"^8.0.0","typescript":"~4.1.3","webpack":"^5.61.0","webpack-cli":"^4.0.0"},"babel":{"presets":["@babel/preset-env","@babel/preset-react","@babel/preset-typescript"]},"jupyterlab":{"extension":"lib/plugin","outputDir":"asqlcell/labextension/","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);