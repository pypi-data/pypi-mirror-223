[tool.poetry]
name = "hoppr-cyclonedx-models"
version = "0.5.2"
description = "CycloneDX Pydantic models for easy use in your Python project."
authors = ["LMCO Open Source <open.source@lmco.com>"]
license = "MIT"
readme = "README.md"
repository = "https://gitlab.com/hoppr/hoppr-cyclonedx-models"

keywords = [
    "pydantic models",
    "cyclonedx",
    "software bill of materials"
]

classifiers = [
    "Development Status :: 2 - Pre-Alpha",
    "Framework :: Pydantic",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Topic :: Software Development :: Code Generators",
]

[[tool.poetry.packages]]
include = "hoppr_cyclonedx_models"

[tool.poetry.dependencies]
python = "^3.7.2"

[tool.poetry.dependencies.pydantic]
extras = ["email"]
version = "^1.10.2"

[tool.poetry.group.dev.dependencies]
black = "^23.1.0"
datamodel-code-generator = ">=0.21.2, <1.0.0"

[tool.poetry.group.dev.dependencies.isort]
version = "^5.12.0"
python = "^3.8.0"

[tool.poetry.group.test.dependencies]
coverage = "^7.0.0"
mypy = "^1.1.1"
pylint = "^2.14.4"
pytest = "^7.1.2"
pytest-cov = "^4.0.0"
pytest-pretty = "^1.1.0"

[tool.black]
color = true
line-length = 120
skip-string-normalization = true
target-version = ["py37"]

[tool.coverage.report]
exclude_also = [
  "if __name__ == .__main__.:",
  "if not TYPE_CHECKING:",
  "if self.debug:",
  "if settings.DEBUG:",
  "if TYPE_CHECKING:",
  "pragma: no cover",
  "raise NotImplementedError"
]
fail_under = 95
omit = ["hoppr_cyclonedx_models/cyclonedx_*/*"]
precision = 2
show_missing = true
skip_covered = true
skip_empty = true

[tool.coverage.run]
command_line = "--module pytest --junit-xml=test.xml"
omit = ["hoppr_cyclonedx_models/cyclonedx_*/*"]
source = ["hoppr_cyclonedx_models"]

[tool.datamodel-codegen]
base-class = "hoppr_cyclonedx_models.base.CycloneDXBaseModel"
collapse-root-models = true
disable-appending-item-suffix = true
disable-warnings = true
enable-version-header = true
field-constraints = true
input-file-type = "jsonschema"
reuse-model = true
target-python-version = "3.7"
use-default-kwarg = true
use-double-quotes = true
use-schema-description = true
use-subclass-enum = true
wrap-string-literal = true

[tool.isort]
atomic = true
lines_between_types = 1
line_length = 120
profile = "black"
py_version = 37
skip_gitignore = true

[tool.mypy]
enable_error_code = ["ignore-without-code"]
explicit_package_bases = true
files = ["hoppr_cyclonedx_models", "tests"]
follow_imports = "silent"
namespace_packages = true
no_implicit_reexport = true
plugins = ["pydantic.mypy"]
pretty = true
python_version = "3.10"
show_error_codes = true
warn_redundant_casts = true
warn_unused_configs = true
warn_unused_ignores = true

[[tool.mypy.overrides]]
module = ["hoppr_cyclonedx_models.*"]
disable_error_code = ["assignment"]

[[tool.mypy.overrides]]
module = ["test.*"]
allow_untyped_defs = true
allow_incomplete_defs = true
allow_untyped_calls = true
ignore_missing_imports = true

[tool.pydantic-mypy]
init_forbid_extra = true
init_typed = true
warn_required_dynamic_aliases = true
warn_untyped_fields = true

[tool.pylint.main]
extension-pkg-whitelist = ["pydantic"]
ignore-paths = ["hoppr_cyclonedx_models/cyclonedx_1_.+.py", "hoppr_cyclonedx_models/spdx.py"]
init-hook = """\
  from pylint.config import find_default_config_files;\
  import sys;\
  sys.path.append(str(list(find_default_config_files())[0].parent / 'hoppr_cyclonedx_models'))\
  """
py-version = "3.7"

[tool.pylint.format]
max-line-length = 120

[tool.pytest.ini_options]
addopts = [
  "--strict-markers",
  "--cov=hoppr_cyclonedx_models",
  "--cov-report=term-missing",
  "--cov-report=xml",
  "--cov-fail-under=100",
  "--ignore-glob=cyclonedx_1_*",
  "--import-mode=importlib",
  "--junit-xml=test.xml"
]
console_output_style = "progress"
junit_family = "xunit2"
pythonpath = ["."]
testpaths = ["tests"]

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"
