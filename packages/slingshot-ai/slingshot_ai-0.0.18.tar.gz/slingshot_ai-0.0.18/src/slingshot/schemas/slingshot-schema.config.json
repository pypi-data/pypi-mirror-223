{
  "$defs": {
    "DeploymentSpec": {
      "example": {
        "environment": "deployment"
      },
      "properties": {
        "name": {
          "default": "deployment",
          "description": "The name of the deployment.",
          "title": "Name",
          "type": "string"
        },
        "environment": {
          "description": "The name of the execution environment.",
          "title": "Environment",
          "type": "string"
        },
        "machine_type": {
          "allOf": [
            {
              "$ref": "#/$defs/MachineType"
            }
          ],
          "default": "CPU_SMALL",
          "description": "The machine size to be used.",
          "title": "Machine size"
        },
        "num_gpu": {
          "default": 0,
          "description": "The number of GPUs to use.",
          "title": "Number of GPUs",
          "type": "integer"
        },
        "config_variables": {
          "description": "Optional user defined arguments to pass to the app.",
          "title": "Arguments",
          "type": "object"
        },
        "mounts": {
          "description": "The mounts to be attached.",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/DownloadByNameMountSpec"
              },
              {
                "$ref": "#/$defs/DownloadByTagMountSpec"
              },
              {
                "$ref": "#/$defs/UploadMountSpec"
              },
              {
                "$ref": "#/$defs/VolumeMountSpec"
              }
            ]
          },
          "title": "Mounts",
          "type": "array"
        },
        "attach_project_credentials": {
          "default": true,
          "description": "If true, will make an API key available to instances under the `SLINGSHOT_API_KEY` environmentvariable so that they can make requests using the Slingshot SDK for this project",
          "title": "Attach project credentials",
          "type": "boolean"
        },
        "cmd": {
          "description": "The command to run.",
          "title": "Command",
          "type": "string"
        }
      },
      "required": [
        "environment",
        "cmd"
      ],
      "title": "Deployment",
      "type": "object"
    },
    "DownloadByNameMountSpec": {
      "properties": {
        "mode": {
          "const": "DOWNLOAD",
          "default": "DOWNLOAD",
          "description": "The mode to use for the mount.",
          "title": "Mode"
        },
        "path": {
          "description": "The path to mount into the environment.",
          "pattern": "/mnt/\\w+",
          "title": "Path",
          "type": "string"
        },
        "name": {
          "description": "The name of the asset to mount. Either name or tag should be set, but not both.",
          "title": "Name",
          "type": "string"
        }
      },
      "required": [
        "path",
        "name"
      ],
      "title": "DownloadByNameMountSpec",
      "type": "object"
    },
    "DownloadByTagMountSpec": {
      "properties": {
        "mode": {
          "const": "DOWNLOAD",
          "default": "DOWNLOAD",
          "description": "The mode to use for the mount.",
          "title": "Mode"
        },
        "path": {
          "description": "The path to mount into the environment.",
          "pattern": "/mnt/\\w+",
          "title": "Path",
          "type": "string"
        },
        "tag": {
          "description": "The artifact selector. If multiple matching artifacts contain the tag, the latest one will be used.  Either name or tag should be set, but not both.",
          "title": "Tag",
          "type": "string"
        }
      },
      "required": [
        "path",
        "tag"
      ],
      "title": "DownloadByTagMountSpec",
      "type": "object"
    },
    "EnvironmentSpec": {
      "example": {
        "python_packages": [
          "numpy",
          "pandas",
          "torch==2.0.1"
        ],
        "python_version": "3.10"
      },
      "properties": {
        "python_version": {
          "anyOf": [
            {
              "const": "3.10"
            },
            {
              "maximum": 3.1,
              "minimum": 3.1,
              "type": "number"
            }
          ],
          "default": "3.10",
          "title": "Python version"
        },
        "python_packages": {
          "description": "List of Python packages to install in the environment.",
          "items": {
            "type": "string"
          },
          "title": "Python packages",
          "type": "array"
        },
        "post_install_command": {
          "default": "",
          "description": "Custom command to run after all packages have been installed. Skipped if not specified.",
          "title": "Post-install command",
          "type": "string"
        },
        "apt_packages": {
          "description": "List of APT packages to install",
          "items": {
            "type": "string"
          },
          "title": "APT packages",
          "type": "array"
        }
      },
      "title": "Environment",
      "type": "object"
    },
    "MachineType": {
      "enum": [
        "T4",
        "L4",
        "A100",
        "CPU_TINY",
        "CPU_SMALL",
        "CPU_MEDIUM",
        "CPU_LARGE"
      ],
      "title": "MachineType",
      "type": "string"
    },
    "RedisAppSpec": {
      "example": {
        "cmd": "python app.py",
        "environment": "slackbot"
      },
      "properties": {
        "name": {
          "description": "The name of the app.",
          "pattern": "^[A-Za-z][A-Za-z0-9_-]*$",
          "title": "Name",
          "type": "string"
        },
        "environment": {
          "description": "The name of the execution environment.",
          "title": "Environment",
          "type": "string"
        },
        "machine_type": {
          "allOf": [
            {
              "$ref": "#/$defs/MachineType"
            }
          ],
          "default": "CPU_SMALL",
          "description": "The machine size to be used.",
          "title": "Machine size"
        },
        "num_gpu": {
          "default": 0,
          "description": "The number of GPUs to use.",
          "title": "Number of GPUs",
          "type": "integer"
        },
        "config_variables": {
          "description": "Optional user defined arguments to pass to the app.",
          "title": "Arguments",
          "type": "object"
        },
        "mounts": {
          "description": "The mounts to be attached.",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/DownloadByNameMountSpec"
              },
              {
                "$ref": "#/$defs/DownloadByTagMountSpec"
              },
              {
                "$ref": "#/$defs/UploadMountSpec"
              },
              {
                "$ref": "#/$defs/VolumeMountSpec"
              }
            ]
          },
          "title": "Mounts",
          "type": "array"
        },
        "attach_project_credentials": {
          "default": true,
          "description": "If true, will make an API key available to instances under the `SLINGSHOT_API_KEY` environmentvariable so that they can make requests using the Slingshot SDK for this project",
          "title": "Attach project credentials",
          "type": "boolean"
        },
        "using": {
          "const": "redis",
          "description": "Which package to use. When specified, this feature automatically adjusts the behavior of the app.",
          "title": "Using"
        }
      },
      "required": [
        "name",
        "environment",
        "using"
      ],
      "title": "App",
      "type": "object"
    },
    "RunSpec": {
      "example": {
        "cmd": "python train.py",
        "environment": "training"
      },
      "properties": {
        "name": {
          "default": "run",
          "description": "The name of the run.",
          "title": "Name",
          "type": "string"
        },
        "environment": {
          "description": "The name of the execution environment.",
          "title": "Environment",
          "type": "string"
        },
        "machine_type": {
          "allOf": [
            {
              "$ref": "#/$defs/MachineType"
            }
          ],
          "default": "CPU_SMALL",
          "description": "The machine size to be used.",
          "title": "Machine size"
        },
        "num_gpu": {
          "default": 0,
          "description": "The number of GPUs to use.",
          "title": "Number of GPUs",
          "type": "integer"
        },
        "config_variables": {
          "description": "Optional user defined arguments to pass to the app.",
          "title": "Arguments",
          "type": "object"
        },
        "mounts": {
          "description": "The mounts to be attached.",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/DownloadByNameMountSpec"
              },
              {
                "$ref": "#/$defs/DownloadByTagMountSpec"
              },
              {
                "$ref": "#/$defs/UploadMountSpec"
              },
              {
                "$ref": "#/$defs/VolumeMountSpec"
              }
            ]
          },
          "title": "Mounts",
          "type": "array"
        },
        "attach_project_credentials": {
          "default": true,
          "description": "If true, will make an API key available to instances under the `SLINGSHOT_API_KEY` environmentvariable so that they can make requests using the Slingshot SDK for this project",
          "title": "Attach project credentials",
          "type": "boolean"
        },
        "cmd": {
          "description": "The command to run.",
          "title": "Command",
          "type": "string"
        }
      },
      "required": [
        "environment",
        "cmd"
      ],
      "title": "Run",
      "type": "object"
    },
    "SessionAppSpec": {
      "example": {
        "cmd": "python app.py",
        "environment": "slackbot"
      },
      "properties": {
        "name": {
          "description": "The name of the app.",
          "pattern": "^[A-Za-z][A-Za-z0-9_-]*$",
          "title": "Name",
          "type": "string"
        },
        "environment": {
          "description": "The name of the execution environment.",
          "title": "Environment",
          "type": "string"
        },
        "machine_type": {
          "allOf": [
            {
              "$ref": "#/$defs/MachineType"
            }
          ],
          "default": "CPU_SMALL",
          "description": "The machine size to be used.",
          "title": "Machine size"
        },
        "num_gpu": {
          "default": 0,
          "description": "The number of GPUs to use.",
          "title": "Number of GPUs",
          "type": "integer"
        },
        "config_variables": {
          "description": "Optional user defined arguments to pass to the app.",
          "title": "Arguments",
          "type": "object"
        },
        "mounts": {
          "description": "The mounts to be attached.",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/DownloadByNameMountSpec"
              },
              {
                "$ref": "#/$defs/DownloadByTagMountSpec"
              },
              {
                "$ref": "#/$defs/UploadMountSpec"
              },
              {
                "$ref": "#/$defs/VolumeMountSpec"
              }
            ]
          },
          "title": "Mounts",
          "type": "array"
        },
        "attach_project_credentials": {
          "default": true,
          "description": "If true, will make an API key available to instances under the `SLINGSHOT_API_KEY` environmentvariable so that they can make requests using the Slingshot SDK for this project",
          "title": "Attach project credentials",
          "type": "boolean"
        },
        "using": {
          "const": "session",
          "description": "Which package to use. When specified, this feature automatically adjusts the behavior of the app.",
          "title": "Using"
        }
      },
      "required": [
        "name",
        "environment",
        "using"
      ],
      "title": "App",
      "type": "object"
    },
    "SlingshotCustomAppSpec": {
      "example": {
        "cmd": "python app.py",
        "environment": "slackbot"
      },
      "properties": {
        "name": {
          "description": "The name of the app.",
          "pattern": "^[A-Za-z][A-Za-z0-9_-]*$",
          "title": "Name",
          "type": "string"
        },
        "environment": {
          "description": "The name of the execution environment.",
          "title": "Environment",
          "type": "string"
        },
        "machine_type": {
          "allOf": [
            {
              "$ref": "#/$defs/MachineType"
            }
          ],
          "default": "CPU_SMALL",
          "description": "The machine size to be used.",
          "title": "Machine size"
        },
        "num_gpu": {
          "default": 0,
          "description": "The number of GPUs to use.",
          "title": "Number of GPUs",
          "type": "integer"
        },
        "config_variables": {
          "description": "Optional user defined arguments to pass to the app.",
          "title": "Arguments",
          "type": "object"
        },
        "mounts": {
          "description": "The mounts to be attached.",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/DownloadByNameMountSpec"
              },
              {
                "$ref": "#/$defs/DownloadByTagMountSpec"
              },
              {
                "$ref": "#/$defs/UploadMountSpec"
              },
              {
                "$ref": "#/$defs/VolumeMountSpec"
              }
            ]
          },
          "title": "Mounts",
          "type": "array"
        },
        "attach_project_credentials": {
          "default": true,
          "description": "If true, will make an API key available to instances under the `SLINGSHOT_API_KEY` environmentvariable so that they can make requests using the Slingshot SDK for this project",
          "title": "Attach project credentials",
          "type": "boolean"
        },
        "port": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The port to expose.",
          "title": "Port"
        },
        "cmd": {
          "description": "The command to run.",
          "title": "Command",
          "type": "string"
        }
      },
      "required": [
        "name",
        "environment",
        "cmd"
      ],
      "title": "App",
      "type": "object"
    },
    "UploadMountSpec": {
      "properties": {
        "mode": {
          "const": "UPLOAD",
          "default": "UPLOAD",
          "description": "The mode to use for the mount.",
          "title": "Mode"
        },
        "path": {
          "description": "The path to mount into the environment.",
          "pattern": "/mnt/\\w+",
          "title": "Path",
          "type": "string"
        },
        "tag": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional tag to attach to the written asset.",
          "title": "Tag"
        }
      },
      "required": [
        "path"
      ],
      "title": "UploadMountSpec",
      "type": "object"
    },
    "VolumeMountSpec": {
      "properties": {
        "mode": {
          "const": "VOLUME",
          "default": "VOLUME",
          "description": "The mode to use for the mount.",
          "title": "Mode"
        },
        "path": {
          "description": "The path to mount into the environment.",
          "pattern": "/mnt/\\w+",
          "title": "Path",
          "type": "string"
        },
        "name": {
          "description": "The name of the volume to mount.",
          "title": "Name",
          "type": "string"
        }
      },
      "required": [
        "path",
        "name"
      ],
      "title": "VolumeMountSpec",
      "type": "object"
    }
  },
  "$id": "https://github.com/slingshot-ai/slingshot/blob/main/slingshot_client/src/slingshot/schemas/slingshot-schema.config.json",
  "$schema": "http://json-schema.org/draft/2020-12/schema",
  "properties": {
    "environments": {
      "additionalProperties": {
        "$ref": "#/$defs/EnvironmentSpec"
      },
      "description": "The environments to use for the job.",
      "title": "Environments",
      "type": "object"
    },
    "apps": {
      "items": {
        "anyOf": [
          {
            "$ref": "#/$defs/SlingshotCustomAppSpec"
          },
          {
            "$ref": "#/$defs/SessionAppSpec"
          },
          {
            "$ref": "#/$defs/RedisAppSpec"
          }
        ]
      },
      "title": "App",
      "type": "array"
    },
    "runs": {
      "items": {
        "$ref": "#/$defs/RunSpec"
      },
      "title": "Run",
      "type": "array"
    },
    "deployments": {
      "items": {
        "$ref": "#/$defs/DeploymentSpec"
      },
      "title": "Deployment",
      "type": "array"
    }
  },
  "title": "Slingshot Config Spec",
  "type": "object"
}