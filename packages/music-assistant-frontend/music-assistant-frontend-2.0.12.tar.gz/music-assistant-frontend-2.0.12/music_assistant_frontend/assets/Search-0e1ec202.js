import{V as S,_ as $,a as B}from"./ItemsListing.vue_vue_type_style_index_0_lang-35d85d87.js";import{l as I,r as o,w as F,o as L,b as _,y as i,I as m,j as c,A as v,R as C,N,F as V,J as b,L as R,z as y,H as E}from"./index-0cff8698.js";import{V as x}from"./VToolbar-bc6bb481.js";import{V as D}from"./VImg-435e9ae7.js";import{V as H}from"./VTextField-d757d379.js";import"./ListviewItem-cf443baf.js";import"./VBadge-8a3c13ec.js";import"./ListItem-cae54af4.js";import"./VMenu-f2e8ec0c.js";import"./VCheckboxBtn-6c29e9c8.js";import"./VCard-b17c950b.js";import"./VTooltip-3ff4ff7f.js";import"./PanelviewItem.vue_vue_type_style_index_0_lang-8fbfb35d.js";import"./contextmenu-73b6c1b4.js";import"./Alert-53569df9.js";import"./Container-a7edcf36.js";import"./VVirtualScroll-c7f16754.js";const ee=I({__name:"Search",props:{initSearch:{}},setup(g){const p=g,a=o(""),n=o(!1),t=o(),d=o(!1),h=o();F(()=>a.value,()=>{clearTimeout(h.value),h.value=setTimeout(()=>{w()},200)});const w=async function(){d.value=!0,localStorage.setItem("globalsearch",a.value),a.value?t.value=await R.search(a.value):t.value=void 0,d.value=!1},f=function(e){if(!t.value)return[];if(e=="artists")return t.value.artists;if(e=="albums")return t.value.albums;if(e=="tracks")return t.value.tracks;if(e=="playlists")return t.value.playlists;if(e=="radio")return t.value.radio;if(e=="topresult"){const r=[];for(const s of[t.value.tracks,t.value.artists,t.value.albums,t.value.playlists,t.value.radio]){const l=[];for(const u of s)l.includes(u.provider)||(r.push(u),l.push(u.provider))}return r}return[]};L(()=>{if(p.initSearch)a.value=p.initSearch;else{const e=localStorage.getItem("globalsearch");e&&e!=="null"&&(a.value=e)}});const k=function(e){!n.value&&e.key=="Backspace"?a.value=a.value.slice(0,-1):!n.value&&e.key.length==1&&(a.value+=e.key)};return document.addEventListener("keydown",k),_(()=>{document.removeEventListener("keydown",k)}),(e,r)=>(i(),m("section",null,[c(x,{variant:"flat",color:"transparent"},{title:v(()=>[C(N(e.$t("search")),1)]),_:1}),c(D),c(H,{id:"searchInput",modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=s=>a.value=s),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("type_to_search"),"hide-details":"",variant:"filled",onFocus:r[1]||(r[1]=s=>n.value=!0),onBlur:r[2]||(r[2]=s=>n.value=!1)},null,8,["modelValue","label"]),(i(),m(V,null,b([["topresult","tracks"],["artists","albums"],["playlists","radio"]],s=>c(B,null,{default:v(()=>[(i(!0),m(V,null,b(s.filter(l=>f(l).length),l=>(i(),y(S,{key:l},{default:v(()=>[f(l).length?(i(),y($,{key:0,itemtype:`search.${l}`,path:`search.${a.value}`,"show-provider":!0,"show-favorites-only-filter":!1,"show-select-button":!1,"show-refresh-button":!1,"load-items":async u=>f(l),title:e.$t(l),"allow-key-hooks":!1,"show-search-button":!1,limit:8,"infinite-scroll":!1,"sort-keys":["original"]},null,8,["itemtype","path","load-items","title"])):E("",!0)]),_:2},1024))),128))]),_:2},1024)),64))]))}});export{ee as default};
